isoclass10_sd<-list(calcul_sd_or_mean(sd,isoclass10,25,10),calcul_sd_or_mean(sd,isoclass10,25,25),calcul_sd_or_mean(sd,isoclass10,25,50))
list_means_by_isoclass_4<-list(isoclass4_mean,isoclass6_mean,isoclass7_mean,isoclass8_mean,isoclass9_mean,isoclass10_mean)
list_sd_by_isoclass_4<-list(isoclass4_sd,isoclass6_sd,isoclass7_sd,isoclass8_sd,isoclass9_sd,isoclass10_sd)
png(file="Figures_simulation2/Graph_types_motif4_conn_25.png")
make_graph_isoclass("Size 4 motif by isoclass \n Connectivity 25%", "bottomright",4,list_isoclass_4,list_means_by_isoclass_4,list_sd_by_isoclass_4)
dev.off()
# 4) Isoclass de motif de taille 3
list_isoclass<-c("isoclass2","isoclass3")
isoclass2_mean<-list(calcul_sd_or_mean(mean,isoclass2,50,10),calcul_sd_or_mean(mean,isoclass2,50,25),calcul_sd_or_mean(mean,isoclass2,50,50))
isoclass3_mean<-list(calcul_sd_or_mean(mean,isoclass3,50,10),calcul_sd_or_mean(mean,isoclass3,50,25),calcul_sd_or_mean(mean,isoclass3,50,50))
isoclass2_sd<-list(calcul_sd_or_mean(sd,isoclass2,50,10),calcul_sd_or_mean(sd,isoclass2,50,25),calcul_sd_or_mean(sd,isoclass2,50,50))
isoclass3_sd<-list(calcul_sd_or_mean(sd,isoclass3,50,10),calcul_sd_or_mean(sd,isoclass3,50,25),calcul_sd_or_mean(sd,isoclass3,50,50))
list_means_by_isoclass<-list(isoclass2_mean,isoclass3_mean)
list_sd_by_isoclass<-list(isoclass2_sd,isoclass3_sd)
png(file="Figures_simulation2/Graph_types_motif3_conn_50.png")
make_graph_isoclass("Size 3 motif by isoclass \n Connectivity 50%", "bottomright",3,list_isoclass,list_means_by_isoclass,list_sd_by_isoclass)
dev.off()
# 5) Isoclass de motif de taille 4
list_isoclass_4<-c("isoclass4","isoclass6","isoclass7","isoclass8","isoclass9","isoclass10")
isoclass4_mean<-list(calcul_sd_or_mean(mean,isoclass4,50,10),calcul_sd_or_mean(mean,isoclass4,50,25),calcul_sd_or_mean(mean,isoclass4,50,50))
isoclass6_mean<-list(calcul_sd_or_mean(mean,isoclass6,50,10),calcul_sd_or_mean(mean,isoclass6,50,25),calcul_sd_or_mean(mean,isoclass6,50,50))
isoclass7_mean<-list(calcul_sd_or_mean(mean,isoclass7,50,10),calcul_sd_or_mean(mean,isoclass7,50,25),calcul_sd_or_mean(mean,isoclass7,50,50))
isoclass8_mean<-list(calcul_sd_or_mean(mean,isoclass8,50,10),calcul_sd_or_mean(mean,isoclass8,50,25),calcul_sd_or_mean(mean,isoclass8,50,50))
isoclass9_mean<-list(calcul_sd_or_mean(mean,isoclass9,50,10),calcul_sd_or_mean(mean,isoclass9,50,25),calcul_sd_or_mean(mean,isoclass9,50,50))
isoclass10_mean<-list(calcul_sd_or_mean(mean,isoclass10,50,10),calcul_sd_or_mean(mean,isoclass10,50,25),calcul_sd_or_mean(mean,isoclass10,50,50))
isoclass4_sd<-list(calcul_sd_or_mean(sd,isoclass4,50,10),calcul_sd_or_mean(sd,isoclass4,50,25),calcul_sd_or_mean(sd,isoclass4,50,50))
isoclass6_sd<-list(calcul_sd_or_mean(sd,isoclass6,50,10),calcul_sd_or_mean(sd,isoclass6,50,25),calcul_sd_or_mean(sd,isoclass6,50,50))
isoclass7_sd<-list(calcul_sd_or_mean(sd,isoclass7,50,10),calcul_sd_or_mean(sd,isoclass7,50,25),calcul_sd_or_mean(sd,isoclass7,50,50))
isoclass8_sd<-list(calcul_sd_or_mean(sd,isoclass8,50,10),calcul_sd_or_mean(sd,isoclass8,50,25),calcul_sd_or_mean(sd,isoclass8,50,50))
isoclass9_sd<-list(calcul_sd_or_mean(sd,isoclass9,50,10),calcul_sd_or_mean(sd,isoclass9,50,25),calcul_sd_or_mean(sd,isoclass9,50,50))
isoclass10_sd<-list(calcul_sd_or_mean(sd,isoclass10,50,10),calcul_sd_or_mean(sd,isoclass10,50,25),calcul_sd_or_mean(sd,isoclass10,50,50))
list_means_by_isoclass_4<-list(isoclass4_mean,isoclass6_mean,isoclass7_mean,isoclass8_mean,isoclass9_mean,isoclass10_mean)
list_sd_by_isoclass_4<-list(isoclass4_sd,isoclass6_sd,isoclass7_sd,isoclass8_sd,isoclass9_sd,isoclass10_sd)
png(file="Figures_simulation2/Graph_types_motif4_conn_50.png")
make_graph_isoclass("Size 4 motif by isoclass \n Connectivity 50%", "bottomright",4,list_isoclass_4,list_means_by_isoclass_4,list_sd_by_isoclass_4)
dev.off()
# 4) Isoclass de motif de taille 3
list_isoclass<-c("isoclass2","isoclass3")
isoclass2_mean<-list(calcul_sd_or_mean(mean,isoclass2,75,10),calcul_sd_or_mean(mean,isoclass2,75,25),calcul_sd_or_mean(mean,isoclass2,75,50))
isoclass3_mean<-list(calcul_sd_or_mean(mean,isoclass3,75,10),calcul_sd_or_mean(mean,isoclass3,75,25),calcul_sd_or_mean(mean,isoclass3,75,50))
isoclass2_sd<-list(calcul_sd_or_mean(sd,isoclass2,75,10),calcul_sd_or_mean(sd,isoclass2,75,25),calcul_sd_or_mean(sd,isoclass2,75,50))
isoclass3_sd<-list(calcul_sd_or_mean(sd,isoclass3,75,10),calcul_sd_or_mean(sd,isoclass3,75,25),calcul_sd_or_mean(sd,isoclass3,75,50))
list_means_by_isoclass<-list(isoclass2_mean,isoclass3_mean)
list_sd_by_isoclass<-list(isoclass2_sd,isoclass3_sd)
png(file="Figures_simulation2/Graph_types_motif3_conn_75.png")
make_graph_isoclass("Size 3 motif by isoclass \n Connectivity 75%", "bottomright",3,list_isoclass,list_means_by_isoclass,list_sd_by_isoclass)
dev.off()
# 5) Isoclass de motif de taille 4
list_isoclass_4<-c("isoclass4","isoclass6","isoclass7","isoclass8","isoclass9","isoclass10")
isoclass4_mean<-list(calcul_sd_or_mean(mean,isoclass4,75,10),calcul_sd_or_mean(mean,isoclass4,75,25),calcul_sd_or_mean(mean,isoclass4,75,50))
isoclass6_mean<-list(calcul_sd_or_mean(mean,isoclass6,75,10),calcul_sd_or_mean(mean,isoclass6,75,25),calcul_sd_or_mean(mean,isoclass6,75,50))
isoclass7_mean<-list(calcul_sd_or_mean(mean,isoclass7,75,10),calcul_sd_or_mean(mean,isoclass7,75,25),calcul_sd_or_mean(mean,isoclass7,75,50))
isoclass8_mean<-list(calcul_sd_or_mean(mean,isoclass8,75,10),calcul_sd_or_mean(mean,isoclass8,75,25),calcul_sd_or_mean(mean,isoclass8,75,50))
isoclass9_mean<-list(calcul_sd_or_mean(mean,isoclass9,75,10),calcul_sd_or_mean(mean,isoclass9,75,25),calcul_sd_or_mean(mean,isoclass9,75,50))
isoclass10_mean<-list(calcul_sd_or_mean(mean,isoclass10,75,10),calcul_sd_or_mean(mean,isoclass10,75,25),calcul_sd_or_mean(mean,isoclass10,75,50))
isoclass4_sd<-list(calcul_sd_or_mean(sd,isoclass4,75,10),calcul_sd_or_mean(sd,isoclass4,75,25),calcul_sd_or_mean(sd,isoclass4,75,50))
isoclass6_sd<-list(calcul_sd_or_mean(sd,isoclass6,75,10),calcul_sd_or_mean(sd,isoclass6,75,25),calcul_sd_or_mean(sd,isoclass6,75,50))
isoclass7_sd<-list(calcul_sd_or_mean(sd,isoclass7,75,10),calcul_sd_or_mean(sd,isoclass7,75,25),calcul_sd_or_mean(sd,isoclass7,75,50))
isoclass8_sd<-list(calcul_sd_or_mean(sd,isoclass8,75,10),calcul_sd_or_mean(sd,isoclass8,75,25),calcul_sd_or_mean(sd,isoclass8,75,50))
isoclass9_sd<-list(calcul_sd_or_mean(sd,isoclass9,75,10),calcul_sd_or_mean(sd,isoclass9,75,25),calcul_sd_or_mean(sd,isoclass9,75,50))
isoclass10_sd<-list(calcul_sd_or_mean(sd,isoclass10,75,10),calcul_sd_or_mean(sd,isoclass10,75,25),calcul_sd_or_mean(sd,isoclass10,75,50))
list_means_by_isoclass_4<-list(isoclass4_mean,isoclass6_mean,isoclass7_mean,isoclass8_mean,isoclass9_mean,isoclass10_mean)
list_sd_by_isoclass_4<-list(isoclass4_sd,isoclass6_sd,isoclass7_sd,isoclass8_sd,isoclass9_sd,isoclass10_sd)
png(file="Figures_simulation2/Graph_types_motif4_conn_75.png")
make_graph_isoclass("Size 4 motif by isoclass \n Connectivity 75%", "bottomright",4,list_isoclass_4,list_means_by_isoclass_4,list_sd_by_isoclass_4)
dev.off()
# 4) Isoclass de motif de taille 3
list_isoclass<-c("isoclass2","isoclass3")
isoclass2_mean<-list(calcul_sd_or_mean(mean,isoclass2,100,10),calcul_sd_or_mean(mean,isoclass2,100,25),calcul_sd_or_mean(mean,isoclass2,100,50))
isoclass3_mean<-list(calcul_sd_or_mean(mean,isoclass3,100,10),calcul_sd_or_mean(mean,isoclass3,100,25),calcul_sd_or_mean(mean,isoclass3,100,50))
isoclass2_sd<-list(calcul_sd_or_mean(sd,isoclass2,100,10),calcul_sd_or_mean(sd,isoclass2,100,25),calcul_sd_or_mean(sd,isoclass2,100,50))
isoclass3_sd<-list(calcul_sd_or_mean(sd,isoclass3,100,10),calcul_sd_or_mean(sd,isoclass3,100,25),calcul_sd_or_mean(sd,isoclass3,100,50))
list_means_by_isoclass<-list(isoclass2_mean,isoclass3_mean)
list_sd_by_isoclass<-list(isoclass2_sd,isoclass3_sd)
png(file="Figures_simulation2/Graph_types_motif3_conn_100.png")
make_graph_isoclass("Size 3 motif by isoclass \n Connectivity 100%", "bottomright",3,list_isoclass,list_means_by_isoclass,list_sd_by_isoclass)
dev.off()
# 5) Isoclass de motif de taille 4
list_isoclass_4<-c("isoclass4","isoclass6","isoclass7","isoclass8","isoclass9","isoclass10")
isoclass4_mean<-list(calcul_sd_or_mean(mean,isoclass4,100,10),calcul_sd_or_mean(mean,isoclass4,100,25),calcul_sd_or_mean(mean,isoclass4,100,50))
isoclass6_mean<-list(calcul_sd_or_mean(mean,isoclass6,100,10),calcul_sd_or_mean(mean,isoclass6,100,25),calcul_sd_or_mean(mean,isoclass6,100,50))
isoclass7_mean<-list(calcul_sd_or_mean(mean,isoclass7,100,10),calcul_sd_or_mean(mean,isoclass7,100,25),calcul_sd_or_mean(mean,isoclass7,100,50))
isoclass8_mean<-list(calcul_sd_or_mean(mean,isoclass8,100,10),calcul_sd_or_mean(mean,isoclass8,100,25),calcul_sd_or_mean(mean,isoclass8,100,50))
isoclass9_mean<-list(calcul_sd_or_mean(mean,isoclass9,100,10),calcul_sd_or_mean(mean,isoclass9,100,25),calcul_sd_or_mean(mean,isoclass9,100,50))
isoclass10_mean<-list(calcul_sd_or_mean(mean,isoclass10,100,10),calcul_sd_or_mean(mean,isoclass10,100,25),calcul_sd_or_mean(mean,isoclass10,100,50))
isoclass4_sd<-list(calcul_sd_or_mean(sd,isoclass4,100,10),calcul_sd_or_mean(sd,isoclass4,100,25),calcul_sd_or_mean(sd,isoclass4,100,50))
isoclass6_sd<-list(calcul_sd_or_mean(sd,isoclass6,100,10),calcul_sd_or_mean(sd,isoclass6,100,25),calcul_sd_or_mean(sd,isoclass6,100,50))
isoclass7_sd<-list(calcul_sd_or_mean(sd,isoclass7,100,10),calcul_sd_or_mean(sd,isoclass7,100,25),calcul_sd_or_mean(sd,isoclass7,100,50))
isoclass8_sd<-list(calcul_sd_or_mean(sd,isoclass8,100,10),calcul_sd_or_mean(sd,isoclass8,100,25),calcul_sd_or_mean(sd,isoclass8,100,50))
isoclass9_sd<-list(calcul_sd_or_mean(sd,isoclass9,100,10),calcul_sd_or_mean(sd,isoclass9,100,25),calcul_sd_or_mean(sd,isoclass9,100,50))
isoclass10_sd<-list(calcul_sd_or_mean(sd,isoclass10,100,10),calcul_sd_or_mean(sd,isoclass10,100,25),calcul_sd_or_mean(sd,isoclass10,100,50))
list_means_by_isoclass_4<-list(isoclass4_mean,isoclass6_mean,isoclass7_mean,isoclass8_mean,isoclass9_mean,isoclass10_mean)
list_sd_by_isoclass_4<-list(isoclass4_sd,isoclass6_sd,isoclass7_sd,isoclass8_sd,isoclass9_sd,isoclass10_sd)
# Only isoclass10 has values other than NaN
png(file="Figures_simulation2/Graph_types_motif4_conn_100.png")
make_graph_isoclass("Size 4 motif by isoclass \n Connectivity 100%", "bottomright",4,list_isoclass_4,list_means_by_isoclass_4,list_sd_by_isoclass_4)
dev.off()
q()
library(phyloseq)
mothlist="C:/Users/Tissicca/Documents/GitHub/TissUni/data/Data_Unifrac/esophagus/esophagus/esophagus.fn.list"
show_mothur_cutoffs(mothlist)
cutoff = "0.10"
x = import_mothur(mothlist, "C:/Users/Tissicca/Documents/GitHub/TissUni/data/Data_Unifrac/esophagus/esophagus/esophagus.good.groups", "C:/Users/Tissicca/Documents/GitHub/TissUni/data/Data_Unifrac/esophagus/esophagus/esophagus.tree", cutoff)
x
# unweighted unifrac
unw_unifrac<-distance(x, method = "unifrac", type = "samples")
# weighted unifrac
w_unifrac<-distance(x, method="wunifrac",type="samples")
# import network
library(SDDE)
source("C:/Users/Tissicca/Documents/GitHub/TissUni/src/create_subgraph_by_colors.r")
source("C:/Users/Tissicca/Documents/GitHub/TissUni/src/get_nb_motifs_by_colors_and_types.r")
source("C:/Users/Tissicca/Documents/GitHub/TissUni/src/get_global_nb_motifs_by_colors.r")
source("C:/Users/Tissicca/Documents/GitHub/TissUni/src/random_network2.r")
reseau<-load_network("C:/Users/Tissicca/Documents/GitHub/TissUni/data/Data_Unifrac/Blast/network_blast.results2.txt_75.txt","C:/Users/Tissicca/Documents/GitHub/TissUni/data/Data_Unifrac/esophagus/esophagus/esophagus.good.groups")
#====== Unifrac_res global
#= Unifrac_res global avec taille de motif 2
B_C_2g<-get_global_nb_motifs_by_colors(reseau,2, "B","C")
B_D_2g<-get_global_nb_motifs_by_colors(reseau,2, "B","D")
C_D_2g<-get_global_nb_motifs_by_colors(reseau,2, "C","D")
#= Unifrac_res global avec taille de motif 3
B_C_3g<-get_global_nb_motifs_by_colors(reseau,3, "B","C")
B_D_3g<-get_global_nb_motifs_by_colors(reseau,3, "B","D")
C_D_3g<-get_global_nb_motifs_by_colors(reseau,3, "C","D")
#= Unifrac_res global avec taille de motif 4
B_C_4g<-get_global_nb_motifs_by_colors(reseau,4, "B","C")
B_D_4g<-get_global_nb_motifs_by_colors(reseau,4, "B","D")
C_D_4g<-get_global_nb_motifs_by_colors(reseau,4, "C","D")
#===== Unifrac_res par types de motif
#= Unifrac_res par types avec taille de motif 3
B_C_3types<-get_nb_motifs_by_colors_and_types(B_C_3g)
B_D_3types<-get_nb_motifs_by_colors_and_types(B_D_3g)
C_D_3types<-get_nb_motifs_by_colors_and_types(C_D_3g)
B_C_3types<-replace(B_C_3types, B_C_3types==-2, NaN)
B_D_3types<-replace(B_D_3types, B_D_3types==-2, NaN)
C_D_3types<-replace(C_D_3types, C_D_3types==-2, NaN)
#= Unifrac_res par types avec taille de motif 4
B_C_4types<-get_nb_motifs_by_colors_and_types(B_C_4g)
B_D_4types<-get_nb_motifs_by_colors_and_types(B_D_4g)
C_D_4types<-get_nb_motifs_by_colors_and_types(C_D_4g)
B_C_4types<-replace(B_C_4types, B_C_4types==-2, NaN)
B_D_4types<-replace(B_D_4types, B_D_4types==-2, NaN)
C_D_4types<-replace(C_D_4types, C_D_4types==-2, NaN)
# création du df avec les différents résultats
#fonction pour faire cela (faut savoir distinguer les groupes)
#create_df_result<-function(){
B_C_unw<-unw_unifrac[1]
B_D_unw<-unw_unifrac[2]
C_D_unw<-unw_unifrac[3]
B_C_w<-w_unifrac[1]
B_D_w<-w_unifrac[2]
C_D_w<-w_unifrac[3]
BC=c(B_C_unw, B_C_w, B_C_2g$ratio, B_C_3g$ratio, B_C_4g$ratio,B_C_3types[1,5],B_C_3types[2,5],as.numeric(as.character(B_C_4types[1,5])),as.numeric(as.character(B_C_4types[2,5])),as.numeric(as.character(B_C_4types[3,5])),as.numeric(as.character(B_C_4types[4,5])),as.numeric(as.character(B_C_4types[5,5])),as.numeric(as.character(B_C_4types[6,5])))
BD=c(B_D_unw, B_D_w, B_D_2g$ratio, B_D_3g$ratio, B_D_4g$ratio,B_D_3types[1,5],B_D_3types[2,5],as.numeric(as.character(B_D_4types[1,5])),as.numeric(as.character(B_D_4types[2,5])),as.numeric(as.character(B_D_4types[3,5])),as.numeric(as.character(B_D_4types[4,5])),as.numeric(as.character(B_D_4types[5,5])),as.numeric(as.character(B_D_4types[6,5])))
CD=c(C_D_unw, C_D_w, C_D_2g$ratio, C_D_3g$ratio, C_D_4g$ratio, C_D_3types[1,5] ,C_D_3types[2,5], as.numeric(as.character(C_D_4types[1,5])),as.numeric(as.character(C_D_4types[2,5])),as.numeric(as.character(C_D_4types[3,5])),as.numeric(as.character(C_D_4types[4,5])),as.numeric(as.character(C_D_4types[5,5])),as.numeric(as.character(C_D_4types[6,5])))
results.comp.df_75<-data.frame(BC,BD,CD,stringsAsFactors=FALSE)
row.names(results.comp.df_75)=c("unweighted unifrac", "weighted unifrac", "global unifrac_res motif size 2", "global unifrac_res motif size 3", "global unifrac_res motif size 4", "unifrac_res motif size 3 isoclass 3", "unifrac_res motif size 3 isoclass 2", "unifrac_res motif size 4 isoclass 10", "unifrac_res motif size 4 isoclass 9", "unifrac_res motif size 4 isoclass 8", "unifrac_res motif size 4 isoclass 7", "unifrac_res motif size 4 isoclass 6", "unifrac_res motif size 4 isoclass 4")
#return(results.comp.df_90)
#}
q()
save(results.comp.df_75, file="results.comp.df_75.rdata")
results.comp.df_75
q()
?sapply
c<-c(1,2,3,4,5)
for i in c {print c}
for (i in c) {print c}
for (i in c) {c}
c
for (i in c) {
i}
for (i in c) {
print i
for (i in c) {
l=i
i
}
l
?print
for (i in c) {
print(i)
}
for (i in c) {
for (j in c+1){
print(i);
print(j);
}
}
for (i in c) {
for (j in c+1){
print("i=");
print(i);
print("j=")
print(j);
}
}
for (i in c) {
cj<-c-c[i]
print(cj)
}
cj<-c[-i]
cj
c
for (i in c) {
cj<-c[-i]
print(cj)}
for (i in couleur){
cj<-c[-i]
for (j in cj){
print("i=");
print(i)
print("j=")
print(j)
}
}
for (i in c) {
cj<-c[-i]
for (j in cj){
print("i=");
print(i)
print("j=")
print(j)
}
}
for (i in c) {
cj<-c[-i]
for (j in cj){
print("i=");
print(i)
print("j=")
print(j)
}
c<-c[-i]
}
for (i in 1:length(c)) {
cj<-c[-(1:i)]
for (j in cj){
print("i=");
print(i)
print("j=")
print(j)
}
}
c
c<-(1,2,3,4,5)
c<-c(1,2,3,4,5)
for (i in 1:length(c)) {
cj<-c[-(1:i)]
for (j in cj){
print("i=");
print(i)
print("j=")
print(j)
}
}
install.pakages("microbenchmark")
install.packages("microbenchmark")
ls()
results.comp.df_75
BC
plot(reseau)
library(SDDE)
plot(reseau)
V(reseau)$tax
?subgraph?
lsd
?subgraph
induced.subgraph(graph, vids, impl=c("auto", "copy_and_delete",
))
induced.subgraph(reseau, vids=c((which(V(reseau)$tax==B)),(which(V(reseau)$tax==C))), impl="copy_and_delete")
induced.subgraph(reseau, vids=c((which(V(reseau)$tax=="B")),(which(V(reseau)$tax=="C"))), impl="copy_and_delete")
BC_graph<-induced.subgraph(reseau, vids=c((which(V(reseau)$tax=="B")),(which(V(reseau)$tax=="C"))), impl="copy_and_delete")
BD_graph<-induced.subgraph(reseau, vids=c((which(V(reseau)$tax=="B")),(which(V(reseau)$tax=="D"))), impl="copy_and_delete")
CD_graph<-induced.subgraph(reseau, vids=c((which(V(reseau)$tax=="C")),(which(V(reseau)$tax=="D"))), impl="copy_and_delete")
BD_graph
CD_graph
plot(BC_graph)
?png
png(file = "BC_graph.png"
)
plot(BC_graph)
dev.off()
png(file = "BD_graph.png"
)
plot(BD_graph)
dev.off()
png(file = "CD_graph.png"
¼
png(file = "CD_graph.png"
)
plot(CD_graph)
dev.off()
?plot
??plot
save.image("C:\\Users\\Tissicca\\Documents\\plot_graph")
V(BD_graph)
V(BD_graph)$tax
V(BD_graph)$color
?replace
replace(V(BD_graph)$tax, which(V(BD_graph)$tax == "B","blue")
)
replace(V(BD_graph)$tax, which(V(BD_graph)$tax == "B"),"blue")
V(BD_graph)$color<-replace(V(BD_graph)$tax, which(V(BD_graph)$tax == "B"),"blue")
V(BD_graph)$color
V(BD_graph)$color<-replace(V(BD_graph)$tax, which(V(BD_graph)$tax == "D"),"green")
V(BD_graph)$color
V(BD_graph)$color<-replace(V(BD_graph)$color, which(V(BD_graph)$color == "B"),"blue")
V(BD_graph)
V(BD_graph)$color
plot(BD_graph)
length(which(V(BD_graph)$color==green)
)
length(which(V(BD_graph)$color=="green"))
length(which(V(BD_graph)$color=="blue"))
png(file = "BD_graph_col.png")
plot(BD_graph)
dev.off()
V(BC_graph)$tax
V(BC_graph)$color<-replace(V(BC_graph)$tax, which(V(BC_graph)$tax == "B"),"blue")
V(BD_graph)$color<-replace(V(BD_graph)$color, which(V(BD_graph)$color == "C"),"orange")
V(BC_graph)$color<-replace(V(BC_graph)$color, which(V(BC_graph)$color == "C"),"orange")
V(BC_graph)
V(BC_graph)$color
plot(BC_graph)
png(file = "BC_graph_col.png")
plot(BC_graph)
dev.off()
V(CD_graph)$color<-replace(V(CD_graph)$tax, which(V(CD_graph)$tax == "C"),"orange")
V(CD_graph)$color<-replace(V(CD_graph)$color, which(V(CD_graph)$color == "D"),"green")
V(CD_graph)$color
plot(CD_graph)
plot(CD_graph,label.color= V(CD_graph)$color)
plot(CD_graph,label.color=V(CD_graph)$color)
plot(CD_graph,vertex.label.color=V(CD_graph)$color)
png(file = "CD_graph_col.png")
plot(CD_graph,vertex.label.color=V(CD_graph)$color)
dev.off()
V(BD_graph)$color<-replace(V(BD_graph)$tax, which(V(BD_graph)$tax == "D"),"green")
V(BD_graph)$color<-replace(V(BD_graph)$color, which(V(BD_graph)$color == "B"),"blue")
png(file = "BD_graph_col.png")
plot(BD_graph,vertex.label.color=V(BD_graph)$color)
dev.off()
V(BC_graph)$color<-replace(V(BC_graph)$tax, which(V(BC_graph)$tax == "C"),"orange")
V(BC_graph)$color<-replace(V(BC_graph)$color, which(V(BC_graph)$color == "B"),"blue")
png(file = "BC_graph_col.png")
plot(BC_graph,vertex.label.color=V(BC_graph)$color)
dev.off()
length(which(V(CD_graph)$color=="green"))
length(which(V(CD_graph)$color=="orange"))
length(which(V(BC_graph)$color=="blue"))
length(which(V(BC_graph)$color=="orange"))
q()
ls()
View(results.comp.df_75)
getwd()
library(igraph)
generarConjuntoDeNodosColor <- function(lnodos, k)
{
listaConjuntos<-list()
i <- 1
while (i<=k)
{
v<- sample(lnodos, 4)
if(coloresVertices(v) == FALSE)
{
listaConjuntos[[length(listaConjuntos)+1]]<-v
i<-i+1
}
print(v)
}
return (listaConjuntos)
}
library(SDDE)
ab<-random_network(10,10,2)
plot(ab)
plot(ab$g2)
generarConjuntoDeNodosColor(V(ab$g2),2)
coloresVertices <- function(v)
{
if ((v$color[1] == v$color[2] )&&(v$color[2]==v$color[3])&&(v$color[3]==v$color[4]))
{
return (TRUE)
}else
{
return (FALSE)
}
}
generarConjuntoDeNodosColor(V(ab$g2),2)
V(ab$g2)
V(ab$g2)$tax
V(ab$g2)$color<-V(ab$g2)$tax
generarConjuntoDeNodosColor(V(ab$g2),2)
generarConjuntoDeNodosColor(V(ab$g2),3)
coloresVertices <- function(v)
{
colors<-as.factor(v$color)
if (levels(colors) ==1){
return(TRUE)
}
else{
return(FALSE)
}
}
coloresVertices(V(ab$g2))
?levels
f <- factor(c("a","b"))
levels(f)
coloresVertices <- function(v)
{
colors<-as.factor(v$color)
if (length(levels(colors)) ==1){
return(TRUE)
}
else{
return(FALSE)
}
#if ((v$color[1] == v$color[2] )&&(v$color[2]==v$color[3])&&(v$color[3]==v$color[4])) #1 et 4?
#{
# return (TRUE)
#}else
#{
# return (FALSE)
#}
}
coloresVertices(V(ab$g2))
coloresVertices(V(ab$g1))
V(ab$g1)$color
V(ab$g1)$color<-V(ab$g1)$tax
coloresVertices(V(ab$g1))
v<-ab$g1
v1<-ab$g2
colors<-as.factor(v$color)
colors
v$color
colors<-as.factor(V(v)$color)
colors
if (length(levels(colors)) ==1){
return(TRUE)
}
else{
return(FALSE)
}
length(levels(colors))==1
colors<-as.factor(V(v1)$color)
length(levels(colors))==1
colors
generarConjuntoDeNodosColor <- function(lnodos, k, size.motif) #limite sur la taille du motif?
{
listaConjuntos<-list()
i <- 1
while (i<=k)
{
v<- sample(lnodos, size.motif)
if(coloresVertices(v) == FALSE)
{
listaConjuntos[[length(listaConjuntos)+1]]<-v
i<-i+1
}
print(v)
}
return (listaConjuntos)
}
generarConjuntoDeNodosColor(V(v1), 5, 5)
?degree.distribution
degree.distribution(v1)
degree.distribution(v1)*4
q()
getwd()
library(igraph)
source(paste0(getwd(),"../src/create_subgraph_by_colors.r",sep=""))
paste0(getwd(),"../src/create_subgraph_by_colors.r",sep="")
reseau<-load_network("ex_carre.txt","tax_carre.txt")
V(reseau)$color=V(reseau)$tax
color<-levels(as.factor(V(reseau)$tax))
for (i in 1:length(color)){
V(reseau)$color=replace(V(reseau)$color,which(V(reseau)$color==color[i]),i)
}
getwd("GitHub//TissUni//examples/")
setwd("GitHub//TissUni//examples/")
reseau<-load_network("ex_carre.txt","tax_carre.txt")
V(reseau)$color=V(reseau)$tax
color<-levels(as.factor(V(reseau)$tax))
for (i in 1:length(color)){
V(reseau)$color=replace(V(reseau)$color,which(V(reseau)$color==color[i]),i)
}
library(SDDE)
reseau<-load_network("ex_carre.txt","tax_carre.txt")
V(reseau)$color=V(reseau)$tax
color<-levels(as.factor(V(reseau)$tax))
for (i in 1:length(color)){
V(reseau)$color=replace(V(reseau)$color,which(V(reseau)$color==color[i]),i)
}
V(reseau)$color
source(paste0(getwd(),"/../src/create_subgraph_by_colors.r",sep=""))
source(paste0(getwd(),"/../src/get_global_nb_motifs_by_colors.R",sep=""))
source(paste0(getwd(),"/../src/get_global_nb_motifs_by_colors.R",sep=""))
source(paste0(getwd(),"/../src/get_nb_motifs_by_colors_and_types",sep=""))
source(paste0(getwd(),"/../src/get_nb_motifs_by_colors_and_types.R",sep=""))
reseau<-load_network("ex_carre.txt","tax_carre.txt")
V(reseau)$color=V(reseau)$tax
color<-levels(as.factor(V(reseau)$tax))
for (i in 1:length(color)){
V(reseau)$color=replace(V(reseau)$color,which(V(reseau)$color==color[i]),i+1)
}
plot(reseau,vertex.color=V(reseau)$color)
motif_global_2<-get_global_nb_motifs_by_colors(reseau,2, "A","B")
motif_global_2
motif_global_3<-get_global_nb_motifs_by_colors(reseau,3, "A","B")
motif_global_3
motif_global_4<-get_global_nb_motifs_by_colors(reseau,4, "A","B")
motif_global_4
types2<-get_nb_motifs_by_colors_and_types(motif_global_2)
